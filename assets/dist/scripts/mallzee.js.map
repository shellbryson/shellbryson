{"version":3,"sources":["mallzee.js"],"names":["$","$body","document","querySelector","$navToggle","$navSecondaryToggle","$nav","$navSecondary","$menuLinks","find","is_open","today","moment","format","lastVisited","localStorage","getItem","ctaHasSignedUp","ctaLastShown","resizeEnd","setItem","url","window","location","href","initForm","formSelector","$mzForm","$submitButton","on","e","now","Date","$timeStamp","$ref","dd","getDate","mm","getMonth","yyyy","getFullYear","val","preventDefault","data","serializeObject","thisForm","ajax","method","dataType","oldText","attr","not","addClass","done","hasClass","pid","conversionId","_pixel","createElement","style","visibility","width","height","src","appendChild","injectLinkedInTracker","before","hide","fail","removeAttr","resizeMenu","removeClass","classList","remove","css","hideIntercom","bool","$intercom","getElementById","display","resetScrollPosition","animate","scrollTop","submit","gtag","event_category","event_label","click","network","this","file","fn","o","a","serializeArray","each","name","push","value","$this","toggleClass","innerHeight","innerWidth","_ih","_iw","_top","offset","top","_os","add","addEventListener","clearTimeout","setTimeout","keyCode","api","GhostContentAPI","key","version","grid","length","posts","browse","filter","limit","then","authors","image","_","sortBy","forEach","author","employee","feature_image","title","excerpt","append","catch","err","console","log","initMallzeeTeamGrid","$date","$page","destination","replace","initResourceForm","popupDelay","timer","setInterval","ls","lv","duration","diff","asDays","removeItem","initPageTimer","ghostHunter","onKeyUp","results","includebodysearch","displaySearchInfo","result_template","roi","action","turnover","lines","net","_revenue","_profit","_m_revenue","_m_net","_m_increase_net","_m_roi","t","l","calcRevenue","calcProfit","toFixed","calcMallzeeNetMargin","calcMallzeeAverageLine","calcMallzeeIncrease","initROI"],"mappings":"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","file":"mallzee.js","sourcesContent":["$(function ($) {\n\n  const $body = document.querySelector('body');\n  const $navToggle = $('[data-navigation-toggle]');\n  const $navSecondaryToggle = $('[data-navigation-secondary-toggle]');\n  const $nav = $('[data-navigation]');\n  const $navSecondary = $('[data-subnavigation]');\n  const $menuItems = $nav.find('li');\n  const $menuLinks = $menuItems.find('a');\n  const is_open = 'js-isOpen';\n  const today = moment().format();\n  const lastVisited = localStorage.getItem(\"mallzee__lastVisited\");\n  const ctaHasSignedUp = localStorage.getItem(\"mallzee__dropCTAHasSignedUp\");\n  const ctaLastShown = localStorage.getItem(\"mallzee__dropCTALastShown\");\n  let resizeEnd;\n\n  localStorage.setItem(\"mallzee__lastVisited\", today);\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Initialise Ghost Hunter search\n  /////////////////////////////////////////////////////////////////////////////\n\n  function initSearch() {\n    $(\"#search-field\").ghostHunter({\n      onKeyUp: true,\n      results: \"#results\",\n      includebodysearch: true,\n      displaySearchInfo: false,\n      result_template: \"<a id='gh-{{ref}}' class='gh-search-item' href='{{link}}'><p>{{title}}</p></a>\"\n    });\n  }\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Bespoke tracking\n  /////////////////////////////////////////////////////////////////////////////\n\n  const url = window.location.href;\n\n  $(\"#newsletterForm\").submit(\n    e => {\n      gtag(\"event\", \"the drop signup\", {\n        event_category: \"form\",\n        event_label: url\n      });\n  });\n\n  $(\"#js-resource\").submit(\n    e => {\n      gtag(\"event\", \"request download\", {\n        event_category: \"form\",\n        event_label: `resource - ${url}`\n      });\n  });\n\n  $(\"#newsletterFooter\").submit(\n    e => {\n      gtag(\"event\", \"the drop signup\", {\n        event_category: \"form\",\n        event_label: `footer - ${url}`\n      });\n  });\n\n  $(\"#newsletterModal\").submit(\n    e => {\n      gtag(\"event\", \"the drop signup\", {\n          event_category: \"form\",\n          event_label: `popup - ${url}`\n      });\n  });\n\n  $(\"#contactForm\").submit(\n    e => {\n      gtag(\"event\", \"get in touch\", {\n        event_category: \"form\",\n        event_label: url\n      });\n  });\n\n  $(\".js-social\").click(\n    e => {\n      const network = $(this).data(\"network\");\n      gtag(\"event\", \"go to social\", {\n        event_category: \"social button\",\n        event_label: network\n      });\n  });\n\n  // Add this class to any link (a tag) that downloads something if you want to track the file\n  $(\".js-download\").click(\n    e => {\n      const file = $(this).attr(\"href\");\n      gtag(\"event\", \"download\", {\n        event_category: \"resource\",\n        event_label: file\n      });\n  });\n\n  /////////////////////////////////////////////////////////////////////////////\n  // The Drop modal handling (timed)\n  /////////////////////////////////////////////////////////////////////////////\n\n  function initPageTimer() {\n    if (!ctaHasSignedUp) {\n      if (!ctaLastShown) {\n        const popupDelay = 90; // seconds\n        let timer = 0;\n        setInterval(\n          () => {\n            timer++;\n            if (timer === popupDelay) {\n              const url = window.location.href;\n              const now = moment().format();\n              localStorage.setItem(\"mallzee__dropCTALastShown\", now);\n              $(\".js-subscribe\").removeClass(\"hidden\");\n\n              gtag(\"event\", \"view\", {\n                event_category: \"popup\",\n                event_label: url\n              });\n            }\n          }, 1000\n        );\n      }\n      if (lastVisited) {\n        // We have shown the modal before\n        if (ctaLastShown) {\n          const ls = moment(ctaLastShown);\n          const lv = moment(lastVisited);\n          const duration = moment.duration(lv.diff(ls));\n          const days = duration.asDays();\n          if (days > 29) {\n            // It has been 30 days since it was last show\n            localStorage.removeItem(\"mallzee__dropCTALastShown\");\n          }\n        }\n      }\n    }\n    $(\".js-modal-close\").on(\"click\", () => {\n      $(\".js-subscribe\").addClass(\"hidden\");\n      gtag(\"event\", \"close\", {\n          event_category: \"popup\",\n          event_label: url\n      });\n    })\n    $(\".js-sign-up\").on(\"click\", () => {\n      localStorage.setItem(\"mallzee__dropCTAHasSignedUp\", \"true\");\n      $(\".js-subscribe\").addClass(\"hidden\");\n    })\n  }\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Initialise various components and helpers\n  /////////////////////////////////////////////////////////////////////////////\n\n  function initGlobalEvents() {\n\n    window.addEventListener(\"resize\", function() {\n      clearTimeout(resizeEnd);\n      resizeEnd = setTimeout( function() {\n        resizeMenu();\n      }, 5);\n    });\n\n    window.addEventListener(\"keyup\", function(e) {\n      if (e.keyCode === 27 && $nav.hasClass(is_open)) {\n        $navToggle.click();\n      }\n    })\n\n    window.addEventListener(\"orientationchange\", function() {\n      resizeMenu();\n    });\n  }\n\n  function injectLinkedInTracker( pid, conversionId ) {\n    let _pixel = document.createElement('img');\n    _pixel.style.visibility = \"hidden\";\n    _pixel.style.width= \"1px\";\n    _pixel.style.height= \"1px\";\n    _pixel.src = `https://dc.ads.linkedin.com/collect/?pid=${pid}&conversionId=${conversionId}&fmt=gif`;\n    $body.appendChild(_pixel);\n  }\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Form helpers\n  /////////////////////////////////////////////////////////////////////////////\n\n  $.fn.serializeObject = function() {\n    var o = {};\n    var a = this.serializeArray();\n    $.each(a, function() {\n      if (o[this.name]) {\n        if (!o[this.name].push) {\n          o[this.name] = [o[this.name]];\n        }\n        o[this.name].push(this.value || '');\n      } else {\n        o[this.name] = this.value || '';\n      }\n    });\n    return o;\n  };\n\n  function initForm( formSelector ) {\n\n    const $mzForm = $( formSelector );\n    const url = \"https://script.google.com/macros/s/AKfycbzYtwIV_HmIBdfpd9cdzj7TrmYvHAGIVDoks7KAgDhy5QiNCaQ/exec\";\n    const $submitButton = $mzForm.find(\"[data-contact-submit]\");\n\n    $mzForm.on(\"submit\", function(e) {\n      const now = new Date();\n      const $timeStamp = $(\"#when\");\n      const $ref = $(\"#ref\");\n\n      let dd = now.getDate();\n      let mm = now.getMonth() + 1;\n      let yyyy = now.getFullYear();\n\n      if (dd < 10) {\n        dd = '0' + dd;\n      }\n\n      if (mm < 10) {\n        mm = '0' + mm;\n      }\n\n      $timeStamp.val( dd + '/' + mm + '/' + yyyy);\n      $ref.val( window.location.href );\n\n      e.preventDefault();\n\n      let data = $mzForm.serializeObject();\n      let thisForm = $.ajax({\n        url: url,\n        method: \"POST\",\n        dataType: \"json\",\n        data: data\n      });\n\n      let oldText = $submitButton.val();\n\n      $submitButton.val(\"Sending form...\");\n      $mzForm.find(\"input\").attr(\"disabled\", \"disabled\").not(\"input[type=submit]\").addClass(\"mz-fade\");\n      thisForm.done(function() {\n        if (!$mzForm.hasClass(\"mz-no-message\")) {\n          injectLinkedInTracker(\"169970\", \"240505\");\n          $submitButton.before(\"<h3>Thanks, we'll be in touch!</h3>\");\n          $submitButton.hide();\n        } else {\n          $submitButton.val(oldText);\n        }\n      });\n\n      thisForm.fail( function() {\n        $submitButton.val( oldText );\n        $mzForm.find(\"input\").removeAttr(\"disabled\");\n        $submitButton.before(\"<h3>Apologies, unable to submit this form right now. Please contact hq@mallzee.com</h3>\")\n      });\n\n    });\n  }\n\n    function initResourceForm() {\n      const $mzForm = $(\"#js-resourceForm\");\n      const url =\"https://script.google.com/macros/s/AKfycbzMleiJwtydMVfVQceUZHy5pviZmV5zMHoYcFgOXfV5grS5iwE/exec\"\n\n      $mzForm.on(\"submit\", function(e) {\n        e.preventDefault();\n        const now = new Date();\n        const $date = $(\"#date\");\n        const $page = $(\"#page\");\n        const file = $(\"#file\").val();\n        const destination = $(\"#destination\").val();\n\n        let dd = now.getDate();\n        let mm = now.getMonth() + 1;\n        let yyyy = now.getFullYear();\n\n        if (dd < 10) {\n          dd = \"0\" + dd;\n        }\n\n        if (mm < 10) {\n          mm = \"0\" + mm;\n        }\n\n        $date.val(dd + \"/\" + mm + \"/\" + yyyy);\n        $page.val(window.location.href);\n\n        e.preventDefault();\n\n        let data = $mzForm.serializeObject();\n        let thisForm = $.ajax({\n            url: url,\n            method: \"POST\",\n            dataType: \"json\",\n            data: data\n        });\n\n        thisForm.done(function() {\n          gtag(\"event\", \"download\", {\n              event_category: \"resource\",\n              event_label: file\n          });\n          window.location.replace(destination);\n        });\n\n        thisForm.fail(function() {\n          console.log(\"ERROR\")\n        });\n      });\n    }\n\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Mallzee Team\n  /////////////////////////////////////////////////////////////////////////////\n\n  function initMallzeeTeamGrid() {\n    const api = new GhostContentAPI({\n      url: \"https://content.mallzee.com\",\n      key: \"24c8d026081fd061cca7648918\",\n      version: 'v2'\n    });\n    const grid = $(\".js-teamGrid\");\n    if (grid.length) {\n      api.posts.browse({ filter: 'tag:hash-staff', limit: \"all\" })\n        .then(authors => {\n          let image;\n          let sortedTeam = _.sortBy(authors, ['title'])\n          sortedTeam.forEach(author => {\n            if (author.feature_image) {\n              image = `<img src=${author.feature_image} alt=\"${author.title}\" />`;\n            } else {\n              image = \"\";\n            }\n            let employee = `<div class=\"team-grid__employee\">\n              <div class=\"team-grid__image\">${image}</div>\n              <div class=\"team-grid__name\">${author.title}</div>\n              <div class=\"team-grid__role\">${author.excerpt}</div>\n            </div>\n          `;\n            grid.append(employee);\n          });\n        })\n        .catch(err => {\n          console.log(err);\n        });\n    }\n  }\n\n\n  /////////////////////////////////////////////////////////////////////////////\n  // ROI\n  /////////////////////////////////////////////////////////////////////////////\n\n  function initROI() {\n    // Input\n    const roi = $(\"#js-roi\");\n    const action = $(roi).find(\"#js-action\");\n    const turnover = $(roi).find(\"#_turnover\");\n    const lines = $(roi).find(\"#_lines\");\n    const gross = $(roi).find(\"#_gross\");\n    const net = $(roi).find(\"#_net\");\n    // Output (current)\n    const _revenue = $(roi).find(\"#_c_revenue\");\n    const _profit = $(roi).find(\"#_c_profit\");\n    // Output (mallzee)\n    const _m_revenue = $(roi).find(\"#_cm_revenue\");\n    const _m_net = $(roi).find(\"#_cm_net\");\n    const _m_increase_net = $(roi).find(\"#_cm_increase_net\");\n    const _m_roi = $(roi).find(\"#_cm_roi\");\n\n    action.on( \"click\", function(e) {\n      e.preventDefault;\n\n      const t = turnover.val() * 1000000;\n      const l = lines.val();\n\n      // Populate current performance // current.toFixed(2)\n      const calcRevenue = t / l;\n      const calcProfit = t / (l * net.val());\n      _revenue.val(calcRevenue.toFixed(2));\n      _profit.val(calcProfit.toFixed(2));\n\n      // Populate Mallzee Insights performance\n      const calcMallzeeNetMargin = net.val() * 1.061;\n      _m_net.val(calcMallzeeNetMargin.toFixed(2));\n\n      const calcMallzeeAverageLine = ((t / l) * calcMallzeeNetMargin) / 100;\n      _m_revenue.val(calcMallzeeAverageLine.toFixed(2));\n\n      const calcMallzeeIncrease = ((calcMallzeeNetMargin / net.val()) -1) * 100;\n      _m_increase_net.val(calcMallzeeIncrease.toFixed(2));\n\n      // const roi = (calcProfit / calcMallzeeAverageLine);\n\n      _m_roi.val(100);\n\n    })\n  }\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Navigation helpers\n  /////////////////////////////////////////////////////////////////////////////\n\n  function resizeMenu() {\n    // Hide primary nav\n    $navToggle.removeClass(is_open).attr('aria-expanded', false);\n    $nav.removeClass(is_open);\n\n    // Hide secondary menu on any resizing\n    $navSecondaryToggle.removeClass(\"active\").attr('aria-expanded', false);\n    $navSecondary.removeClass(\"active\").attr('aria-hidden', true);\n\n    $body.classList.remove('mz-no-scroll');\n    $nav.css('height', 'inherit');\n  }\n\n  // If we have Intercom chat engaugement active, it can cover elements of the\n  // mobile menu, so here we hide Intercom if the menu is toggled\n\n  function hideIntercom( bool ) {\n    $intercom = document.getElementById(\"intercom-container\");\n    if ($intercom) {\n      if (bool) {\n        $intercom.style.display = 'none';\n      } else {\n        $intercom.style.display = 'block';\n      }\n    }\n  }\n\n  // Used to prevent page becoming \"fixed\" while partly out of viewport on\n  // trigger of mobile menu\n\n  function resetScrollPosition() {\n    $(\"html, body\").animate({ scrollTop: 0 }, \"slow\");\n  }\n\n  // Mobile navigation toggle\n\n  $navToggle.on('click', function () {\n    const $this = $(this);\n\n    $this.toggleClass(is_open)\n      .attr('aria-expanded') === 'true' ?\n      $this.attr('aria-expanded', false) : $this.attr('aria-expanded', true);\n\n    $nav.toggleClass(is_open)\n      .attr('aria-hidden') === 'true' ?\n      $nav.attr('aria-hidden', false) : $nav.attr('aria-hidden', true);\n\n    $menuLinks.attr('tabindex') === '-1' ?\n      $menuLinks.attr('tabindex', '') : $menuLinks.attr('tabindex', '-1');\n\n    if (window.innerHeight && window.innerWidth) {\n      const _ih = window.innerHeight;\n      const _iw = window.innerWidth;\n      const _top = $nav.offset().top;\n\n      if (_iw < 1024) {\n\n        if ($nav.hasClass(is_open)) {\n          const _os = _ih - _top;\n          $nav.css('height',  _os + \"px\");\n          resetScrollPosition();\n          $body.classList.add('mz-no-scroll');\n        } else {\n          $body.classList.remove('mz-no-scroll');\n          $nav.css('height', 'inherit');\n        }\n\n      } else {\n        $body.classList.remove('mz-no-scroll');\n        $nav.css('height', 'inherit');\n      }\n\n    }\n\n    if ($nav.hasClass(is_open)) {\n      hideIntercom(true);\n    } else {\n      hideIntercom(false);\n    }\n\n  });\n\n  $navSecondaryToggle.on('click', function(e) {\n    const $this = $(this);\n    e.preventDefault();\n\n    $(this).toggleClass(\"active\")\n      .attr('aria-expanded') === 'true' ?\n      $(this).attr('aria-expanded', false) : $(this).attr('aria-expanded', true);\n\n    $navSecondary.toggleClass(\"active\")\n      .attr('aria-hidden') === 'true' ?\n      $navSecondary.attr('aria-hidden', false) : $navSecondary.attr('aria-hidden', true);\n\n    resetScrollPosition();\n  });\n\n  /////////////////////////////////////////////////////////////////////////////\n  // Run The Stuff...\n  /////////////////////////////////////////////////////////////////////////////\n\n  initGlobalEvents();\n  initMallzeeTeamGrid();\n  initForm( \"[data-contact-form]\" );\n  initForm( \"[data-trial-form]\" );\n  initResourceForm();\n  initPageTimer();\n  initSearch();\n  initROI();\n\n});\n\n\n"]}